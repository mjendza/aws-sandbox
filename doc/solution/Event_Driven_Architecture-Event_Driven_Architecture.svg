<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1499px" preserveAspectRatio="none" style="width:1145px;height:1499px;background:#FFFFFF;" version="1.1" viewBox="0 0 1145 1499" width="1145px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="203" x="464.5" y="18.6855">Event Driven Architecture</text><!--MD5=[75ef508db7e2562f27a98a8cfcc9f97f]
cluster B2CTenant--><rect fill="#FFFFFF" height="1442" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="1132" x="7" y="29.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="535" y="46.1738">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="81" x="532.5" y="65.8594">Serverless</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="547.5" y="81.832">[System]</text><!--MD5=[bd009e6794c3cf654f7ffc4016319f2c]
cluster RestAPI--><rect fill="#FFFFFF" height="413" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="437" x="97" y="269.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="277.5" y="286.1738">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="61" x="285" y="305.8594">RestAPI</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="290" y="321.832">[System]</text><!--MD5=[fe164bb4d694f42e99d36b252b850cc3]
cluster EventBridgeRuleHandlers--><rect fill="#FFFFFF" height="213" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="883" x="232" y="991.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="635.5" y="1008.1738">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="211" x="568" y="1027.8594">Event Bridge Rule Handlers</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="648" y="1043.832">[System]</text><!--MD5=[dbd2c5333a3db7d547cc13cee0d15777]
cluster DynamoDataStore--><rect fill="#FFFFFF" height="193" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="285" x="81" y="1254.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="185.5" y="1271.1738">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="140" x="153.5" y="1290.8594">DynamoDataStore</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="198" y="1306.832">[System]</text><!--MD5=[a75a013ed46674b8090207b0ba62c3fb]
cluster EventBridgeService--><rect fill="#FFFFFF" height="193" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="598" x="78" y="732.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="339" y="749.1738">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="152" x="301" y="768.8594">EventBridgeService</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="51" x="351.5" y="784.832">[System]</text><!--MD5=[f367faf0381a60654cb678c2cea65232]
entity EndUser--><rect fill="#686868" height="90.4375" style="stroke:#8A8A8A;stroke-width:1.5;" width="123" x="97.5" y="100.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="103" x="107.5" y="123.0977">«external_person»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="36" x="141" y="142.3438">User</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="161" y="160.3926"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="146.5" y="178.002">User</text><!--MD5=[645d8587175d8f7ad110cd370775931d]
entity API--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="116" x="193" y="340.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="218.5" y="363.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="96" x="203" y="382.3438">API Gateway</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="248" y="398.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="253" y="415.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="253" y="433.0957"/><!--MD5=[6288c10c517d8f7724a956163927791b]
entity LambdaRestGetUsersHandler--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="187" x="113.5" y="550.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="174.5" y="573.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="162" x="126" y="592.3438">Get All Users Handler</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="204" y="608.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="209" y="625.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="127.5" y="643.0957">handle get all users event</text><!--MD5=[ff3eabf0cb889cdc984218de75208abf]
entity LambdaRestPostUserHandler--><rect fill="#438DD5" height="125.6563" style="stroke:#3C7FC0;stroke-width:1.5;" width="182" x="336" y="540.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="394.5" y="563.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="154" x="348" y="582.3438">Create User Handler</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="62" x="396" y="602.4688">Lambda</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="424" y="618.4414">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="429" y="635.6113"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="350" y="653.2207">handle create user event</text><!--MD5=[648f1f00944eecd6c9308020089b9e99]
entity LambdaCreateUserHandler--><rect fill="#438DD5" height="125.6563" style="stroke:#3C7FC0;stroke-width:1.5;" width="182" x="248" y="1062.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="306.5" y="1085.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="154" x="260" y="1104.3438">Create User Handler</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="62" x="308" y="1124.4688">Lambda</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="336" y="1140.4414">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="341" y="1157.6113"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="262" y="1175.2207">handle create user event</text><!--MD5=[16ae3dab0c50a74df83ad39dcb936d9d]
entity LambdaUserCreatedHandler--><rect fill="#438DD5" height="125.6563" style="stroke:#3C7FC0;stroke-width:1.5;" width="190" x="465" y="1062.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="527.5" y="1085.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="154" x="481" y="1104.3438">Create User Handler</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="62" x="529" y="1124.4688">Lambda</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="557" y="1140.4414">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="562" y="1157.6113"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="479" y="1175.2207">handle user created event</text><!--MD5=[1daf1b63aad0b4f21e82d282f6f5dcab]
entity StartPaymentFlowHandler--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="220" x="690" y="1072.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="767.5" y="1095.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="200" x="700" y="1114.3438">StartPaymentFlowHandler</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="797" y="1130.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="802" y="1147.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="719" y="1165.0957">handle user created event</text><!--MD5=[003f9db01d6c1ac8a539ce3e23328fc3]
entity LambdaEventStoreHandler--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="154" x="945" y="1072.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="989.5" y="1095.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="134" x="955" y="1114.3438">Handle All Events</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="1019" y="1130.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="1024" y="1147.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="970.5" y="1165.0957">handle all events</text><!--MD5=[b060bc174516cd49f9b8bed266993f17]
entity EventStore--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="124" x="226" y="1325.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="255.5" y="1348.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="85" x="245.5" y="1367.3438">EventStore</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="285" y="1383.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="290" y="1400.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="240" y="1418.0957">Store All Events</text><!--MD5=[feb5939ce823acf5a8245c3205b3c7a1]
entity Users--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="93" x="97.5" y="1325.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="111.5" y="1348.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="45" x="121.5" y="1367.3438">Users</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="141" y="1383.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="146" y="1400.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="111.5" y="1418.0957">User Table</text><!--MD5=[7fbd984f87d8341f48d31fe311a5fa4d]
entity EventBridge--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="115" x="544.5" y="803.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="569.5" y="826.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="95" x="554.5" y="845.3438">EventBridge</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="599" y="861.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="604" y="878.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="565.5" y="896.0957">EventBridge</text><!--MD5=[c2992e70fd8fe7abf2d54785a0b9924f]
entity CreateUserEventRule--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="185" x="324.5" y="803.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="384.5" y="826.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="165" x="334.5" y="845.3438">CreateUserEventRule</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="414" y="861.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="419" y="878.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="350.5" y="896.0957">CreateUserEventRule</text><!--MD5=[c316c4fc645b68151507d0c254bd82c1]
entity CreatedUserEventRule--><rect fill="#438DD5" height="105.5313" style="stroke:#3C7FC0;stroke-width:1.5;" width="195" x="94.5" y="803.6406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65" x="159.5" y="826.0977">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="175" x="104.5" y="845.3438">CreatedUserEventRule</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="6" x="189" y="861.3164">[]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="194" y="878.4863"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="121.5" y="896.0957">CreatedUserEventRule</text><!--MD5=[540e4975271b8dc5f0caf88bc86f6461]
link EndUser to API--><path d="M111.06,190.7406 C96.42,209.6006 86.42,232.1806 96,253.6406 C115.04,296.3006 154.37,331.3106 188.64,355.5306 " fill="none" id="EndUser-to-API" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="192.79,358.4306,187.693,350.0033,188.6878,355.572,183.1191,356.5668,192.79,358.4306" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="149" y="235.1357">Uses</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="133" x="97" y="250.4492">[HTTP Get users [{user}]]</text><!--MD5=[540e4975271b8dc5f0caf88bc86f6461]
link EndUser to API--><path d="M214.17,190.7106 C222.4,199.7506 229.84,209.8406 235,220.6406 C252.01,256.2306 255.76,300.6606 255.39,335.4406 " fill="none" id="EndUser-to-API-1" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="255.31,340.5006,259.4637,331.5705,255.3957,335.5014,251.4649,331.4334,255.31,340.5006" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="299.5" y="235.1357">Uses</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="134" x="247" y="250.4492">[HTTP POST user {user}]</text><!--MD5=[719555c8d9728a225d2c35b4b3048185]
link API to LambdaRestGetUsersHandler--><path d="M239.95,446.8606 C233.62,476.7806 225.67,514.3706 219.17,545.1306 " fill="none" id="API-to-LambdaRestGetUsersHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="218.05,550.4006,223.8136,542.4143,219.0772,545.5073,215.9842,540.7708,218.05,550.4006" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="241.5" y="491.1357">API handler to</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="233" y="507.4873">consume payload</text><!--MD5=[3302524b6db841645f553d71e0dcc4d6]
link LambdaRestGetUsersHandler to Users--><path d="M133.47,656.9306 C112.18,675.8206 91.16,698.9006 78,724.6406 C33.75,811.1706 57.01,844.6406 51,941.6406 C45.45,1031.2706 36.22,1117.2306 61,1212.6406 C70.87,1250.6506 90.3,1290.0606 107.87,1320.8306 " fill="none" id="LambdaRestGetUsersHandler-to-Users" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="110.45,1325.3006,109.4369,1315.504,107.9601,1320.9647,102.4994,1319.4879,110.45,1325.3006" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="52" y="964.1357">send CreateUser event</text><!--MD5=[4cd1fc6acf149bc270be44bdc5dbf966]
link API to LambdaRestPostUserHandler--><path d="M309.15,434.7706 C324.77,447.1206 340.94,461.5006 354,476.6406 C369.35,494.4406 383.18,515.9306 394.57,536.0806 " fill="none" id="API-to-LambdaRestPostUserHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="397.11,540.6206,396.2358,530.8106,394.6818,536.2498,389.2426,534.6958,397.11,540.6206" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="386.5" y="491.1357">API handler to</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="378" y="507.4873">consume payload</text><!--MD5=[d755537dc60b149cb81e9696275e15ed]
link LambdaRestPostUserHandler to EventBridge--><path d="M482.34,666.8406 C497.49,684.9706 513.46,705.1506 527,724.6406 C543.26,748.0406 559.25,775.2006 572.25,798.7006 " fill="none" id="LambdaRestPostUserHandler-to-EventBridge" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="574.81,803.3506,573.9739,793.5373,572.3988,798.9704,566.9656,797.3953,574.81,803.3506" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="520" y="713.1357">send CreateUser event</text><!--MD5=[1cd81670505292ecc30abf12ee6ad8a3]
link EventBridge to LambdaCreateUserHandler--><path d="M560.04,909.8906 C550.16,919.1906 538.99,927.7706 527,933.6406 C500.07,946.8306 485.52,925.9006 460,941.6406 C416.7,968.3506 385.65,1017.0006 365.84,1057.4406 " fill="none" id="EventBridge-to-LambdaCreateUserHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="363.48,1062.3206,370.9938,1055.9533,365.6529,1057.8175,363.7888,1052.4766,363.48,1062.3206" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109" x="461" y="956.1357">CreateUser event</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="493" y="972.4873">handler</text><!--MD5=[ef2274a6d6f6f537474e4420e086dd91]
link LambdaCreateUserHandler to Users--><path d="M262.42,1188.7106 C243.55,1206.2106 224.38,1226.1106 209,1246.6406 C192.16,1269.1206 177.74,1296.6306 166.79,1320.6306 " fill="none" id="LambdaCreateUserHandler-to-Users" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="164.64,1325.3806,171.9887,1318.8234,166.6972,1320.8234,164.6971,1315.5319,164.64,1325.3806" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51" x="231" y="1235.1357">put user</text><!--MD5=[5480008f7167ca8865d959251c01fb55]
link Users to EventBridge--><path d="M118.73,1325.4806 C82.29,1241.7806 28.21,1077.3906 114,983.6406 C120.78,976.2306 194.04,976.8806 204,975.6406 C298.26,963.8706 320.65,952.5906 415,941.6406 C439.79,938.7606 504.34,944.0806 527,933.6406 C537.75,928.6906 547.81,921.4706 556.85,913.4406 " fill="none" id="Users-to-EventBridge" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="560.66,909.9506,551.326,913.0934,556.9778,913.3331,556.738,918.9849,560.66,909.9506" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="115" y="1123.1357">send UserCreated</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="155.5" y="1139.4873">event</text><!--MD5=[af2bc27bab1ac2a47a0c57702096a162]
link EventBridge to StartPaymentFlowHandler--><path d="M659.71,890.1706 C680.43,903.9806 702.68,921.5606 719,941.6406 C749.2,978.8006 770.36,1028.9806 783.46,1067.4006 " fill="none" id="EventBridge-to-StartPaymentFlowHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="785.17,1072.5006,786.0833,1062.6942,783.5717,1067.7629,778.503,1065.2514,785.17,1072.5006" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117" x="741" y="956.1357">UserCreated event</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="777" y="972.4873">handler</text><!--MD5=[2957401d2e6f50ecb3208858da98a313]
link EventBridge to LambdaUserCreatedHandler--><path d="M593.8,909.7506 C587.17,951.9206 577.78,1011.6206 570.58,1057.3906 " fill="none" id="EventBridge-to-LambdaUserCreatedHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="569.8,1062.3406,575.1633,1054.0802,570.5849,1057.4026,567.2625,1052.8243,569.8,1062.3406" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117" x="589" y="956.1357">UserCreated event</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49" x="625" y="972.4873">handler</text><!--MD5=[0c0326d2c8e92d58c33f28d7c9304119]
link EventBridge to LambdaEventStoreHandler--><path d="M659.73,864.8306 C732.14,876.8506 855.54,907.6906 928,983.6406 C952.1,1008.9006 974.05,1041.0306 990.67,1068.2406 " fill="none" id="EventBridge-to-LambdaEventStoreHandler" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="993.29,1072.5606,992.0273,1062.7931,990.6903,1068.2896,985.1937,1066.9526,993.29,1072.5606" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109" x="915" y="964.1357">All event handler</text><!--MD5=[b442ce757c3e1614f0452a0bfd7535c7]
link LambdaEventStoreHandler to EventStore--><path d="M973.84,1178.9506 C960.07,1191.4806 944.34,1203.7906 928,1212.6406 C736.4,1316.4806 476.83,1357.0606 355.6,1371.0906 " fill="none" id="LambdaEventStoreHandler-to-EventStore" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="350.29,1371.7006,359.6879,1374.6467,355.2573,1371.1297,358.7744,1366.6991,350.29,1371.7006" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="913" y="1235.1357">EventBrige EventStore</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="538.5" y="1491.1738">MJendza</text><!--MD5=[e89867a120fe5a564bd0482abf7ee9ff]
@startuml Event Driven Architecture
!includeurl https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/release/1-0/C4_Container.puml

title
Event Driven Architecture
end title

caption MJendza

System_Boundary(B2CTenant, "Serverless") {
   System_Boundary(RestAPI, "RestAPI") {
            Container(API, "API Gateway", "", "")
            Container(LambdaRestGetUsersHandler, "Get All Users Handler", "", "handle get all users event")
            Container(LambdaRestPostUserHandler, "Create User Handler Lambda", "", "handle create user event")
   }
   System_Boundary(EventBridgeRuleHandlers, "Event Bridge Rule Handlers") {
           Container(LambdaCreateUserHandler, "Create User Handler Lambda", "", "handle create user event")
           Container(LambdaUserCreatedHandler, "Create User Handler Lambda", "", "handle user created event")
           Container(StartPaymentFlowHandler, "StartPaymentFlowHandler", "", "handle user created event")
           Container(LambdaEventStoreHandler, "Handle All Events", "", "handle all events")
   }
   Person_Ext(EndUser, User, "User")

   System_Boundary(DynamoDataStore, "DynamoDataStore") {
        Container(EventStore, "EventStore", "", "Store All Events")
        Container(Users, "Users", "", "User Table")
   }

   System_Boundary(EventBridgeService, "EventBridgeService") {
        Container(EventBridge, "EventBridge", "", "EventBridge")
        Container(CreateUserEventRule, "CreateUserEventRule", "", "CreateUserEventRule")
        Container(CreatedUserEventRule, "CreatedUserEventRule", "", "CreatedUserEventRule")
   }
}
Rel(EndUser, API, "Uses", "HTTP Get users [{user}]")
Rel(API, LambdaRestGetUsersHandler, "API handler to consume payload")
Rel(LambdaRestGetUsersHandler, Users, "send CreateUser event")

Rel(EndUser, API, "Uses", "HTTP POST user {user}")
Rel(API, LambdaRestPostUserHandler, "API handler to consume payload")
Rel(LambdaRestPostUserHandler, EventBridge, "send CreateUser event")

Rel(EventBridge, LambdaCreateUserHandler, "CreateUser event handler")
Rel(LambdaCreateUserHandler, Users, "put user")

Rel(Users, EventBridge, "send UserCreated event")

Rel(EventBridge, StartPaymentFlowHandler, "UserCreated event handler")
Rel(EventBridge, LambdaUserCreatedHandler, "UserCreated event handler")
Rel(EventBridge, LambdaEventStoreHandler, "All event handler")
Rel(LambdaEventStoreHandler, EventStore, "EventBrige EventStore")
@enduml

@startuml Event Driven Architecture





skinparam defaultTextAlignment center

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam rectangle {
    StereotypeFontSize 12
    shadowing false
}

skinparam database {
    StereotypeFontSize 12
    shadowing false
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

skinparam rectangle<<boundary>> {
    Shadowing false
    StereotypeFontSize 0
    FontColor #444444
    BorderColor #444444
    BorderStyle dashed
}






















skinparam rectangle<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}

skinparam rectangle<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}

skinparam rectangle<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam rectangle<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}

skinparam database<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam database<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
















skinparam rectangle<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}

skinparam database<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}








title
Event Driven Architecture
end title

caption MJendza

rectangle "==Serverless\n<size:12>[System]</size>" <<boundary>> as B2CTenant {
   rectangle "==RestAPI\n<size:12>[System]</size>" <<boundary>> as RestAPI {
            rectangle "==API Gateway\n//<size:12>[]</size>//\n\n " <<container>> as API
            rectangle "==Get All Users Handler\n//<size:12>[]</size>//\n\n handle get all users event" <<container>> as LambdaRestGetUsersHandler
            rectangle "==Create User Handler Lambda\n//<size:12>[]</size>//\n\n handle create user event" <<container>> as LambdaRestPostUserHandler
   }
   rectangle "==Event Bridge Rule Handlers\n<size:12>[System]</size>" <<boundary>> as EventBridgeRuleHandlers {
           rectangle "==Create User Handler Lambda\n//<size:12>[]</size>//\n\n handle create user event" <<container>> as LambdaCreateUserHandler
           rectangle "==Create User Handler Lambda\n//<size:12>[]</size>//\n\n handle user created event" <<container>> as LambdaUserCreatedHandler
           rectangle "==StartPaymentFlowHandler\n//<size:12>[]</size>//\n\n handle user created event" <<container>> as StartPaymentFlowHandler
           rectangle "==Handle All Events\n//<size:12>[]</size>//\n\n handle all events" <<container>> as LambdaEventStoreHandler
   }
   rectangle "==User\n\n User" <<external_person>> as EndUser

   rectangle "==DynamoDataStore\n<size:12>[System]</size>" <<boundary>> as DynamoDataStore {
        rectangle "==EventStore\n//<size:12>[]</size>//\n\n Store All Events" <<container>> as EventStore
        rectangle "==Users\n//<size:12>[]</size>//\n\n User Table" <<container>> as Users
   }

   rectangle "==EventBridgeService\n<size:12>[System]</size>" <<boundary>> as EventBridgeService {
        rectangle "==EventBridge\n//<size:12>[]</size>//\n\n EventBridge" <<container>> as EventBridge
        rectangle "==CreateUserEventRule\n//<size:12>[]</size>//\n\n CreateUserEventRule" <<container>> as CreateUserEventRule
        rectangle "==CreatedUserEventRule\n//<size:12>[]</size>//\n\n CreatedUserEventRule" <<container>> as CreatedUserEventRule
   }
}
EndUser - -> API : "===Uses\n//<size:12>[HTTP Get users [{user}]]</size>//"
API - -> LambdaRestGetUsersHandler : "===API handler to consume payload"
LambdaRestGetUsersHandler - -> Users : "===send CreateUser event"

EndUser - -> API : "===Uses\n//<size:12>[HTTP POST user {user}]</size>//"
API - -> LambdaRestPostUserHandler : "===API handler to consume payload"
LambdaRestPostUserHandler - -> EventBridge : "===send CreateUser event"

EventBridge - -> LambdaCreateUserHandler : "===CreateUser event handler"
LambdaCreateUserHandler - -> Users : "===put user"

Users - -> EventBridge : "===send UserCreated event"

EventBridge - -> StartPaymentFlowHandler : "===UserCreated event handler"
EventBridge - -> LambdaUserCreatedHandler : "===UserCreated event handler"
EventBridge - -> LambdaEventStoreHandler : "===All event handler"
LambdaEventStoreHandler - -> EventStore : "===EventBrige EventStore"
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>